"use client"
import Link from "next/link"
import { Button } from "@/components/ui/button"
import { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from "@/components/ui/card"
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs"
import { Badge } from "@/components/ui/badge"
import { DashboardHeader } from "@/components/dashboard-header"
import { DashboardShell } from "@/components/dashboard-shell"
import { AlertCircle, ArrowLeft, Bug, Lock, Search, Shield, WormIcon as Virus } from "lucide-react"
import { MalwareSimulator } from "@/components/malware-simulator"

export default function MalwareProtectionPage() {
  return (
    <DashboardShell>
      <div className="flex items-center">
        <Button variant="ghost" size="sm" asChild className="mr-2">
          <Link href="/dashboard">
            <ArrowLeft className="mr-2 h-4 w-4" />
            Back to Dashboard
          </Link>
        </Button>
      </div>

      <DashboardHeader
        heading="Malware Protection Module"
        text="Learn about different types of malware and protection strategies"
      >
        <Badge variant="outline" className="ml-2">
          40% Complete
        </Badge>
      </DashboardHeader>

      <Tabs defaultValue="simulator" className="space-y-4">
        <TabsList>
          <TabsTrigger value="simulator">Malware Lab</TabsTrigger>
          <TabsTrigger value="types">Malware Types</TabsTrigger>
          <TabsTrigger value="protection">Protection Strategies</TabsTrigger>
          <TabsTrigger value="incident">Incident Response</TabsTrigger>
        </TabsList>

        <TabsContent value="simulator" className="space-y-4">
          <MalwareSimulator />
        </TabsContent>

        <TabsContent value="types" className="space-y-4">
          <Card>
            <CardHeader>
              <CardTitle>Types of Malware</CardTitle>
              <CardDescription>Understanding different malware categories and their behaviors</CardDescription>
            </CardHeader>
            <CardContent className="space-y-4">
              <div className="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3">
                <div className="rounded-md border p-4">
                  <div className="flex items-center space-x-2">
                    <Virus className="h-5 w-5 text-red-500" />
                    <h3 className="font-medium">Virus</h3>
                  </div>
                  <p className="mt-2 text-sm text-muted-foreground">
                    Self-replicating malicious code that attaches to legitimate programs and executes when the host
                    program runs
                  </p>
                  <div className="mt-2 rounded-md bg-muted p-2 text-xs">
                    <strong>Indicators:</strong> Slow performance, file corruption, unexpected behavior
                  </div>
                </div>

                <div className="rounded-md border p-4">
                  <div className="flex items-center space-x-2">
                    <Bug className="h-5 w-5 text-amber-500" />
                    <h3 className="font-medium">Worm</h3>
                  </div>
                  <p className="mt-2 text-sm text-muted-foreground">
                    Self-replicating malware that spreads across networks without requiring user interaction
                  </p>
                  <div className="mt-2 rounded-md bg-muted p-2 text-xs">
                    <strong>Indicators:</strong> Network slowdowns, high CPU/memory usage, unexpected connections
                  </div>
                </div>

                <div className="rounded-md border p-4">
                  <div className="flex items-center space-x-2">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      strokeWidth="2"
                      strokeLinecap="round"
                      strokeLinejoin="round"
                      className="text-blue-500"
                    >
                      <path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5" />
                      <path d="M9 18h6" />
                      <path d="M10 22h4" />
                    </svg>
                    <h3 className="font-medium">Trojan</h3>
                  </div>
                  <p className="mt-2 text-sm text-muted-foreground">
                    Malware disguised as legitimate software that creates backdoors for unauthorized access
                  </p>
                  <div className="mt-2 rounded-md bg-muted p-2 text-xs">
                    <strong>Indicators:</strong> Unexpected system changes, data theft, unauthorized access
                  </div>
                </div>

                <div className="rounded-md border p-4">
                  <div className="flex items-center space-x-2">
                    <Lock className="h-5 w-5 text-purple-500" />
                    <h3 className="font-medium">Ransomware</h3>
                  </div>
                  <p className="mt-2 text-sm text-muted-foreground">
                    Encrypts user data and demands payment for the decryption key
                  </p>
                  <div className="mt-2 rounded-md bg-muted p-2 text-xs">
                    <strong>Indicators:</strong> Inaccessible files, ransom notes, file extensions changed
                  </div>
                </div>

                <div className="rounded-md border p-4">
                  <div className="flex items-center space-x-2">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      strokeWidth="2"
                      strokeLinecap="round"
                      strokeLinejoin="round"
                      className="text-green-500"
                    >
                      <path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" />
                      <line x1="12" y1="9" x2="12" y2="13" />
                      <line x1="12" y1="17" x2="12.01" y2="17" />
                    </svg>
                    <h3 className="font-medium">Spyware</h3>
                  </div>
                  <p className="mt-2 text-sm text-muted-foreground">
                    Secretly monitors user activity and collects sensitive information
                  </p>
                  <div className="mt-2 rounded-md bg-muted p-2 text-xs">
                    <strong>Indicators:</strong> Slow performance, privacy breaches, unexpected ads
                  </div>
                </div>

                <div className="rounded-md border p-4">
                  <div className="flex items-center space-x-2">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      strokeWidth="2"
                      strokeLinecap="round"
                      strokeLinejoin="round"
                      className="text-orange-500"
                    >
                      <rect x="2" y="4" width="20" height="16" rx="2" />
                      <path d="M12 12h.01" />
                    </svg>
                    <h3 className="font-medium">Rootkit</h3>
                  </div>
                  <p className="mt-2 text-sm text-muted-foreground">
                    Provides privileged access while hiding its presence from detection
                  </p>
                  <div className="mt-2 rounded-md bg-muted p-2 text-xs">
                    <strong>Indicators:</strong> Hidden processes, system instability, persistent threats
                  </div>
                </div>
              </div>

              <div className="rounded-md bg-muted p-4">
                <h3 className="mb-2 font-medium">Malware Infection Vectors</h3>
                <ul className="list-disc pl-5 text-sm">
                  <li>
                    <strong>Phishing emails:</strong> Malicious attachments or links
                  </li>
                  <li>
                    <strong>Drive-by downloads:</strong> Automatic downloads from compromised websites
                  </li>
                  <li>
                    <strong>Removable media:</strong> Infected USB drives or external storage
                  </li>
                  <li>
                    <strong>Software vulnerabilities:</strong> Exploiting unpatched security flaws
                  </li>
                  <li>
                    <strong>Social engineering:</strong> Tricking users into installing malware
                  </li>
                </ul>
              </div>
            </CardContent>
          </Card>
        </TabsContent>

        <TabsContent value="protection" className="space-y-4">
          <Card>
            <CardHeader>
              <CardTitle>Protection Strategies</CardTitle>
              <CardDescription>Techniques and tools to prevent and detect malware infections</CardDescription>
            </CardHeader>
            <CardContent className="space-y-4">
              <div className="grid grid-cols-1 gap-4 md:grid-cols-2">
                <div>
                  <h3 className="mb-2 text-lg font-medium">Preventive Measures</h3>
                  <div className="space-y-2">
                    <div className="rounded-md border p-3">
                      <div className="flex items-center space-x-2">
                        <Shield className="h-5 w-5 text-green-500" />
                        <h4 className="font-medium">Keep Software Updated</h4>
                      </div>
                      <p className="mt-1 text-sm text-muted-foreground">
                        Regularly update operating systems and applications to patch security vulnerabilities
                      </p>
                    </div>

                    <div className="rounded-md border p-3">
                      <div className="flex items-center space-x-2">
                        <Shield className="h-5 w-5 text-green-500" />
                        <h4 className="font-medium">Use Antivirus Software</h4>
                      </div>
                      <p className="mt-1 text-sm text-muted-foreground">
                        Install and maintain reputable antivirus software with real-time protection
                      </p>
                    </div>

                    <div className="rounded-md border p-3">
                      <div className="flex items-center space-x-2">
                        <Shield className="h-5 w-5 text-green-500" />
                        <h4 className="font-medium">Practice Safe Browsing</h4>
                      </div>
                      <p className="mt-1 text-sm text-muted-foreground">
                        Avoid suspicious websites and be cautious when downloading files
                      </p>
                    </div>

                    <div className="rounded-md border p-3">
                      <div className="flex items-center space-x-2">
                        <Shield className="h-5 w-5 text-green-500" />
                        <h4 className="font-medium">Email Security</h4>
                      </div>
                      <p className="mt-1 text-sm text-muted-foreground">
                        Be wary of unexpected attachments and verify sender identities
                      </p>
                    </div>
                  </div>
                </div>

                <div>
                  <h3 className="mb-2 text-lg font-medium">Detection & Removal</h3>
                  <div className="space-y-2">
                    <div className="rounded-md border p-3">
                      <div className="flex items-center space-x-2">
                        <Search className="h-5 w-5 text-blue-500" />
                        <h4 className="font-medium">Signature-Based Detection</h4>
                      </div>
                      <p className="mt-1 text-sm text-muted-foreground">
                        Identifies malware by comparing files against a database of known malware signatures
                      </p>
                    </div>

                    <div className="rounded-md border p-3">
                      <div className="flex items-center space-x-2">
                        <Search className="h-5 w-5 text-blue-500" />
                        <h4 className="font-medium">Heuristic Analysis</h4>
                      </div>
                      <p className="mt-1 text-sm text-muted-foreground">
                        Detects suspicious behavior patterns that may indicate previously unknown malware
                      </p>
                    </div>

                    <div className="rounded-md border p-3">
                      <div className="flex items-center space-x-2">
                        <Search className="h-5 w-5 text-blue-500" />
                        <h4 className="font-medium">Sandboxing</h4>
                      </div>
                      <p className="mt-1 text-sm text-muted-foreground">
                        Executes suspicious files in an isolated environment to observe behavior
                      </p>
                    </div>

                    <div className="rounded-md border p-3">
                      <div className="flex items-center space-x-2">
                        <Search className="h-5 w-5 text-blue-500" />
                        <h4 className="font-medium">System Scanning</h4>
                      </div>
                      <p className="mt-1 text-sm text-muted-foreground">
                        Regular full system scans to detect and remove hidden malware
                      </p>
                    </div>
                  </div>
                </div>
              </div>

              <div className="rounded-md bg-muted p-4">
                <h3 className="mb-2 font-medium">Advanced Protection Techniques</h3>
                <div className="grid grid-cols-1 gap-2 md:grid-cols-2">
                  <div>
                    <h4 className="text-sm font-medium">Application Whitelisting</h4>
                    <p className="text-xs text-muted-foreground">
                      Only allows approved applications to run on a system
                    </p>
                  </div>

                  <div>
                    <h4 className="text-sm font-medium">Behavior Monitoring</h4>
                    <p className="text-xs text-muted-foreground">
                      Continuously monitors system for suspicious activities
                    </p>
                  </div>

                  <div>
                    <h4 className="text-sm font-medium">Network Segmentation</h4>
                    <p className="text-xs text-muted-foreground">Limits malware spread by isolating network segments</p>
                  </div>

                  <div>
                    <h4 className="text-sm font-medium">Endpoint Protection Platforms</h4>
                    <p className="text-xs text-muted-foreground">Comprehensive security solutions for endpoints</p>
                  </div>
                </div>
              </div>
            </CardContent>
          </Card>
        </TabsContent>

        <TabsContent value="incident" className="space-y-4">
          <Card>
            <CardHeader>
              <CardTitle>Incident Response</CardTitle>
              <CardDescription>Steps to take when a malware infection is detected</CardDescription>
            </CardHeader>
            <CardContent className="space-y-4">
              <div className="rounded-md border p-4">
                <h3 className="mb-2 text-lg font-medium">Incident Response Plan</h3>
                <div className="space-y-4">
                  <div className="flex items-center space-x-4">
                    <div className="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10">
                      <span className="text-lg font-bold">1</span>
                    </div>
                    <div>
                      <h4 className="font-medium">Identification</h4>
                      <p className="text-sm text-muted-foreground">
                        Detect and confirm the malware infection through system scans and behavior analysis
                      </p>
                    </div>
                  </div>

                  <div className="flex items-center space-x-4">
                    <div className="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10">
                      <span className="text-lg font-bold">2</span>
                    </div>
                    <div>
                      <h4 className="font-medium">Containment</h4>
                      <p className="text-sm text-muted-foreground">
                        Isolate affected systems to prevent malware from spreading to other parts of the network
                      </p>
                    </div>
                  </div>

                  <div className="flex items-center space-x-4">
                    <div className="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10">
                      <span className="text-lg font-bold">3</span>
                    </div>
                    <div>
                      <h4 className="font-medium">Eradication</h4>
                      <p className="text-sm text-muted-foreground">
                        Remove the malware from all affected systems using appropriate tools and techniques
                      </p>
                    </div>
                  </div>

                  <div className="flex items-center space-x-4">
                    <div className="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10">
                      <span className="text-lg font-bold">4</span>
                    </div>
                    <div>
                      <h4 className="font-medium">Recovery</h4>
                      <p className="text-sm text-muted-foreground">
                        Restore systems to normal operation, recover data from backups if necessary
                      </p>
                    </div>
                  </div>

                  <div className="flex items-center space-x-4">
                    <div className="flex h-10 w-10 items-center justify-center rounded-full bg-primary/10">
                      <span className="text-lg font-bold">5</span>
                    </div>
                    <div>
                      <h4 className="font-medium">Lessons Learned</h4>
                      <p className="text-sm text-muted-foreground">
                        Analyze the incident to improve security posture and prevent future infections
                      </p>
                    </div>
                  </div>
                </div>
              </div>

              <div className="grid grid-cols-1 gap-4 md:grid-cols-2">
                <div className="rounded-md border p-4">
                  <h3 className="mb-2 font-medium">Emergency Response Toolkit</h3>
                  <ul className="list-disc pl-5 text-sm">
                    <li>Bootable antivirus rescue disk</li>
                    <li>Live operating system (Linux) for offline scanning</li>
                    <li>Network monitoring tools</li>
                    <li>System log analyzers</li>
                    <li>Data recovery tools</li>
                    <li>Forensic analysis software</li>
                  </ul>
                </div>

                <div className="rounded-md border p-4">
                  <h3 className="mb-2 font-medium">When to Seek Professional Help</h3>
                  <ul className="list-disc pl-5 text-sm">
                    <li>Ransomware has encrypted critical data</li>
                    <li>Malware persists despite removal attempts</li>
                    <li>Sensitive data may have been compromised</li>
                    <li>Multiple systems are affected</li>
                    <li>Advanced persistent threats are suspected</li>
                    <li>Legal or regulatory compliance is required</li>
                  </ul>
                </div>
              </div>

              <div className="rounded-md bg-muted p-4">
                <div className="flex items-center space-x-2">
                  <AlertCircle className="h-5 w-5 text-amber-500" />
                  <h3 className="font-medium">Important Considerations</h3>
                </div>
                <ul className="mt-2 list-disc pl-5 text-sm">
                  <li>Document all steps taken during incident response</li>
                  <li>Maintain chain of custody if legal action may be required</li>
                  <li>Consider reporting serious incidents to law enforcement</li>
                  <li>Communicate appropriately with stakeholders</li>
                  <li>Test your incident response plan regularly</li>
                </ul>
              </div>
            </CardContent>
            <CardFooter>
              <Button className="w-full">Start Incident Response Simulation</Button>
            </CardFooter>
          </Card>
        </TabsContent>
      </Tabs>
    </DashboardShell>
  )
}

